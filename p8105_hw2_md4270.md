p8105_hw2_md4270
================
Manye Dong
2023-09-30

``` r
library(tidyverse)
library(readr)
library(readxl)
```

## Problem 1

### clean pols_month dataset

``` r
# clean snp dataset
pols_month = 
  read_csv("pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, sep = "-", into = c("year", "month", "day")) |>
  mutate(year = as.numeric(year), month = as.numeric(month), 
         day = as.numeric(day), month = month.name[month],
         president = ifelse(prez_gop==0, "dem", "gop")) |>
  select(-c(prez_dem, prez_gop, day))

head(pols_month)
```

    ## # A tibble: 6 × 9
    ##    year month    gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##   <dbl> <chr>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ## 1  1947 January       23      51     253      23      45     198 dem      
    ## 2  1947 February      23      51     253      23      45     198 dem      
    ## 3  1947 March         23      51     253      23      45     198 dem      
    ## 4  1947 April         23      51     253      23      45     198 dem      
    ## 5  1947 May           23      51     253      23      45     198 dem      
    ## 6  1947 June          23      51     253      23      45     198 dem

### clean snp dataset

``` r
snp = 
  read_csv("snp.csv") |>
  janitor::clean_names() |>
  separate(date, sep = "/", into = c("month", "day", "year")) |>
  mutate(year = as.numeric(year), month = as.numeric(month), 
         day = as.numeric(day), month = month.name[month], 
         year = ifelse((50<=year & year<100), 1900+year, 2000+year)) |>
  select(year, month, close)

head(snp)
```

    ## # A tibble: 6 × 3
    ##    year month    close
    ##   <dbl> <chr>    <dbl>
    ## 1  2015 July     2080.
    ## 2  2015 June     2063.
    ## 3  2015 May      2107.
    ## 4  2015 April    2086.
    ## 5  2015 March    2068.
    ## 6  2015 February 2104.

### Clean Unemployment Dataset

``` r
unemployment = 
  read_csv("unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "umployment_percent") |>
  mutate(year = as.numeric(year), 
         month = recode(month, 
                   "jan" = "January", 
                   "feb" = "February", 
                   "mar" = "March", 
                   "apr" = "April", 
                   "may" = "May", 
                   "jun" = "June", 
                   "jul" = "July", 
                   "aug" = "August", 
                   "sep" = "September", 
                   "oct" = "October", 
                   "nov" = "November", 
                   "dec" = "December"))

head(unemployment)
```

    ## # A tibble: 6 × 3
    ##    year month    umployment_percent
    ##   <dbl> <chr>                 <dbl>
    ## 1  1948 January                 3.4
    ## 2  1948 February                3.8
    ## 3  1948 March                   4  
    ## 4  1948 April                   3.9
    ## 5  1948 May                     3.5
    ## 6  1948 June                    3.6

``` r
# merge the three datasets
joined = left_join(pols_month, snp) |>
  left_join(x = _, y = unemployment)
```

    ## Joining with `by = join_by(year, month)`
    ## Joining with `by = join_by(year, month)`

``` r
joined
```

    ## # A tibble: 822 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: umployment_percent <dbl>

Write a short paragraph about these datasets. Explain briefly what each
dataset contained, and describe the resulting dataset (e.g. give the
dimension, range of years, and names of key variables):

The resulting dataset contains 822 rows and 11 columns. The range of the
year goes from 1947 to 2015.

## Problem 2

### Mr. Trash Wheel

``` r
mister_trash = 
  read_excel("202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel", range = "A2:N586") |>
  janitor::clean_names() |>
  separate(date, sep ="-", into = c("year", "month", "day")) |>
  mutate(homes_powered = (weight_tons * 500) / 30, 
         month = month.abb[as.numeric(month)],
         wheel = "mister") |>
  drop_na()

tail(mister_trash)
```

    ## # A tibble: 6 × 15
    ##   dumpster year  month day   weight_tons volume_cubic_yards plastic_bottles
    ##      <dbl> <chr> <chr> <chr>       <dbl>              <dbl>           <dbl>
    ## 1      579 2023  May   04           3.66                 15            2200
    ## 2      580 2023  May   04           2.62                 15            3100
    ## 3      581 2023  Jun   28           3.56                 15            3400
    ## 4      582 2023  Jun   28           3.79                 15            4000
    ## 5      583 2023  Jun   28           2.28                 10            2100
    ## 6      584 2023  Jun   29           3.9                  15            1900
    ## # ℹ 8 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   sports_balls <dbl>, homes_powered <dbl>, wheel <chr>

``` r
# load and clean the Professor Trash Wheel
prof_trash = 
  read_excel("202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel", range = "A2:M108") |>
  janitor::clean_names() |>
  separate(date, sep ="-", into = c("year", "month", "day")) |>
  mutate(homes_powered = (weight_tons * 500) / 30, 
         month = month.abb[as.numeric(month)],
         wheel = "professor") |>
  drop_na()

tail(prof_trash)
```

    ## # A tibble: 6 × 14
    ##   dumpster year  month day   weight_tons volume_cubic_yards plastic_bottles
    ##      <dbl> <chr> <chr> <chr>       <dbl>              <dbl>           <dbl>
    ## 1      100 2022  Dec   17           1.98                 15            3200
    ## 2      101 2022  Dec   29           2.13                 15            4200
    ## 3      102 2023  Feb   15           2.41                 15            2900
    ## 4      104 2023  Apr   20           2.58                 15            3400
    ## 5      105 2023  Jun   16           1.85                 15            4100
    ## 6      106 2023  Jun   29           2.25                 15            3900
    ## # ℹ 7 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   homes_powered <dbl>, wheel <chr>

``` r
# load and clean the Professor Trash Wheel
gwynnda_trash = 
  read_excel("202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynnda Trash Wheel", range = "A2:L157") |>
  janitor::clean_names() |>
  separate(date, sep ="-", into = c("year", "month", "day")) |>
  mutate(homes_powered = (weight_tons * 500) / 30, 
         month = month.abb[as.numeric(month)],
         wheel = "gwynnda") |>
  drop_na()

tail(gwynnda_trash)
```

    ## # A tibble: 6 × 13
    ##   dumpster year  month day   weight_tons volume_cubic_yards plastic_bottles
    ##      <dbl> <chr> <chr> <chr>       <dbl>              <dbl>           <dbl>
    ## 1      149 2023  Jun   28           2.68                 15            5400
    ## 2      150 2023  Jun   29           2.74                 15            4400
    ## 3      151 2023  Jun   29           3.12                 15            5000
    ## 4      152 2023  Jun   29           3.12                 15            3400
    ## 5      153 2023  Jun   29           3.45                 15            4900
    ## 6      154 2023  Jun   30           2.88                 15            2500
    ## # ℹ 6 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   plastic_bags <dbl>, wrappers <dbl>, homes_powered <dbl>, wheel <chr>

Now we combine those three datasets:

``` r
trash_wheels =
  bind_rows(mister_trash, prof_trash, gwynnda_trash) |>
  janitor::clean_names()

tail(trash_wheels)
```

    ## # A tibble: 6 × 15
    ##   dumpster year  month day   weight_tons volume_cubic_yards plastic_bottles
    ##      <dbl> <chr> <chr> <chr>       <dbl>              <dbl>           <dbl>
    ## 1      149 2023  Jun   28           2.68                 15            5400
    ## 2      150 2023  Jun   29           2.74                 15            4400
    ## 3      151 2023  Jun   29           3.12                 15            5000
    ## 4      152 2023  Jun   29           3.12                 15            3400
    ## 5      153 2023  Jun   29           3.45                 15            4900
    ## 6      154 2023  Jun   30           2.88                 15            2500
    ## # ℹ 8 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   sports_balls <dbl>, homes_powered <dbl>, wheel <chr>

- There are 727 rows/observations in the resulting dataset.

- Key variables include dumpster id, year-month-day as the time of the
  record for the

- The total weight of trash collected by Professor Trash Wheel is 214.21
  in tons.

``` r
filtered_gywnnda =  
  gwynnda_trash |>
  select(year, month, cigarette_butts) |>
  filter(year=="2021", month=="Jul")

head(filtered_gywnnda)
```

- The total number of cigarette butts collected by Gwynnda in July of
  2021 is 0 (16300).

## Problem 3

### Baseline Dataset

``` r
MCI_baseline = read_csv("MCI_baseline.csv", skip=1)
```

``` r
MCI_cleaned = 
  MCI_baseline |>
  janitor::clean_names() |>
  mutate(sex = ifelse(sex==0, "Female", "Male"), 
         apoe4 = ifelse(apoe4==0, "Non-carrier", "Carrier"),
         age_at_onset = as.numeric(age_at_onset)) |>
  filter(age_at_onset != "NA")

head(MCI_cleaned)
```

    ## # A tibble: 6 × 6
    ##      id current_age sex    education apoe4       age_at_onset
    ##   <dbl>       <dbl> <chr>      <dbl> <chr>              <dbl>
    ## 1     3        62.5 Male          16 Carrier             66.8
    ## 2     5        66   Male          16 Non-carrier         68.7
    ## 3     7        66.5 Male          18 Non-carrier         74  
    ## 4    13        63.1 Male          12 Carrier             69  
    ## 5    14        58.4 Female        20 Non-carrier         66.2
    ## 6    18        67.8 Male          16 Non-carrier         69.8

- I used “skip=1” parameter when importing data to exclude the first row
  of the because it will mess up with the column names one row below.

- Relevant features of the dataset include current age of participants,
  their gender, education in years, and the age at onset of MCI in
  decimal form after data cleaning.

- There were originally 483 participants recruited, of these 97 develop
  MCI the follow-up period.

- The average baseline age is 70.2628866.

``` r
# Check the proportion of women who are APOE4 carriers
MCI_women = 
  MCI_cleaned |>
  filter(sex=="Female")

MCI_women_carrier = 
  MCI_cleaned |>
  filter(sex=="Female", apoe4=="Carrier")
```

- 65.2173913% of women in the study are APOE4 carriers.

### Longitudinal Study

``` r
amyloid =
  read_csv("mci_amyloid.csv", skip = 1) |>
  janitor::clean_names()
```

    ## Rows: 487 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (5): Baseline, Time 2, Time 4, Time 6, Time 8
    ## dbl (1): Study ID
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(amyloid)
```

    ## # A tibble: 6 × 6
    ##   study_id baseline    time_2      time_4      time_6      time_8     
    ##      <dbl> <chr>       <chr>       <chr>       <chr>       <chr>      
    ## 1        1 0.1105487   <NA>        0.109325197 0.104756131 0.107257697
    ## 2        2 0.107481183 0.109157373 0.109457839 0.105729713 0.10661845 
    ## 3        3 0.106087034 0.108744509 0.106065035 <NA>        0.106152357
    ## 4        4 0.109251358 0.108699686 0.110540386 0.107476797 0.111212209
    ## 5        5 0.107950408 0.112273883 0.115139677 0.106606054 0.106052066
    ## 6        6 0.112426974 0.112853415 0.11143945  0.110279277 0.114982747

Here, I also used “skip=1” parameter to exclude the first row because it
is not the column names we want. Check whether some participants appear
in only the baseline or amyloid datasets, and comment on your findings.

Combine the demographic and biomarker datasets so that only participants
who appear in both datasets are retained, and briefly describe the
resulting dataset

``` r
MCI_df = inner_join(MCI_cleaned, amyloid, by = c("id" = "study_id"))

head(MCI_df)
```

    ## # A tibble: 6 × 11
    ##      id current_age sex    education apoe4   age_at_onset baseline time_2 time_4
    ##   <dbl>       <dbl> <chr>      <dbl> <chr>          <dbl> <chr>    <chr>  <chr> 
    ## 1     3        62.5 Male          16 Carrier         66.8 0.10608… 0.108… 0.106…
    ## 2     5        66   Male          16 Non-ca…         68.7 0.10795… 0.112… 0.115…
    ## 3     7        66.5 Male          18 Non-ca…         74   0.11224… <NA>   0.104…
    ## 4    13        63.1 Male          12 Carrier         69   0.11030… 0.108… 0.108…
    ## 5    18        67.8 Male          16 Non-ca…         69.8 0.11413… 0.107… 0.110…
    ## 6    22        67.3 Female        20 Carrier         74.6 0.10932… <NA>   0.107…
    ## # ℹ 2 more variables: time_6 <chr>, time_8 <chr>

Export the result as a CSV to your data directory.

``` r
write.csv(MCI_df, file = "MCI_df.csv")
```
